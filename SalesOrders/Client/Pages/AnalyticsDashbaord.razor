@page "/analytics"
@using SalesOrders.Client.Service.OrdersService
@inject IOrderService Orders
@inject IJSRuntime JS

<div id="chart"></div>

@code {
    private OrderTypeStatsVM orderTypeStats;
    protected override async Task OnInitializedAsync()
    {
        var response = await Orders.GetOrderTypeStats();
        if (response != null)
        {
            orderTypeStats = response;

            // Prepare data for the chart
            var chartData = new
            {
                series = orderTypeStats.orderTypes.Select(ot => ot.Values.First()).ToArray(),
                labels = orderTypeStats.orderTypes.Select(ot => ot.Keys.First()).ToArray()
            };

            // Pass the data to the JavaScript function
            await JS.InvokeVoidAsync("renderChart", chartData);
        }
    }
}
